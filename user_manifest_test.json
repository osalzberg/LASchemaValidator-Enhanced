{
  "type": "Microsoft.SecurityInsights/GCP",
  "displayName": "Azure Sentinel GCP",
  "description": "All tables related to GCP.",
  "tags": {},
  "properties": {},
  "simplifiedSchemaVersion": "3",
  "icmTeam": "Microsoft Azure Sentinel/Data Collection and Processing",
  "contactDL": "asipolarbearseng@microsoft.com",
  "relatedTables": [],
  "relatedFunctions": [],
  "tables": [
    {
      "name": "GCPAuditLogs",
      "description": "The Google Cloud Platform (GCP) audit logs, ingested from Sentinel's connector, enable you to capture three types of audit logs: admin activity logs, data access logs, and access transparency logs. Google cloud audit Logs record a trail that practitioners can use to monitor access and detect potential threats across Google Cloud Platform (GCP) resources.",
      "categories": [
        "security"
      ],
      "tags": {},
      "properties": {},
      "artifactVersion": 3,
      "dataTypeId": "SENTINEL_GCP_AUDIT_LOGS",
      "intelligencePacks": [
        "SecurityInsights"
      ],
      "isResourceCentric": false,
      "tableState": "Production",
      "isTroubleshootingAllowed": true,
      "isLakeAllowed": true,
      "input": [
        {
          "name": "protoPayload",
          "type": "Dynamic"
        },
        {
          "name": "insertId",
          "type": "String"
        },
        {
          "name": "resource",
          "type": "Dynamic"
        },
        {
          "name": "severity",
          "type": "String"
        },
        {
          "name": "logName",
          "type": "String"
        },
        {
          "name": "receiveTimestamp",
          "type": "DateTime"
        },
        {
          "name": "timestamp",
          "type": "DateTime"
        }
      ],
      "transformFilePath": "KQL/GCPAuditLogsTransform.kql",
      "columns": [
        {
          "name": "TimeGenerated",
          "type": "DateTime",
          "description": "The time the log entry was received by logging."
        },
        {
          "name": "ServiceName",
          "type": "String",
          "description": "The name of the API service performing the operation. For example, 'compute.googleapis.com'."
        },
        {
          "name": "MethodName",
          "type": "String",
          "description": "The name of the service method or operation. For API calls, this should be the name of the API method."
        },
        {
          "name": "GCPResourceName",
          "type": "String",
          "description": "The resource or collection that is the target of the operation. The name is a scheme-less URI, not including the API service name."
        },
        {
          "name": "NumResponseItems",
          "type": "String",
          "description": "The number of items returned from a list or query API method, if applicable."
        },
        {
          "name": "Status",
          "type": "Dynamic",
          "description": "The status of the overall operation."
        },
        {
          "name": "AuthenticationInfo",
          "type": "Dynamic",
          "description": "Authentication information."
        },
        {
          "name": "AuthorizationInfo",
          "type": "Dynamic",
          "description": "Authorization information. If there are multiple resources or permissions involved, then there is one AuthorizationInfo element for each {resource, permission} tuple."
        },
        {
          "name": "RequestMetadata",
          "type": "Dynamic",
          "description": "Metadata about the operation."
        },
        {
          "name": "Request",
          "type": "Dynamic",
          "description": "The operation request. This may not include all request parameters, such as those that are too large, privacy-sensitive, or duplicated elsewhere in the log record. It should never include user-generated data, such as file contents. When the JSON object represented here has a proto equivalent, the proto name will be indicated in the @type property."
        },
        {
          "name": "Response",
          "type": "Dynamic",
          "description": "The operation response. This may not include all response elements, such as those that are too large, privacy-sensitive, or duplicated elsewhere in the log record. It should never include user-generated data, such as file contents. When the JSON object represented here has a proto equivalent, the proto name will be indicated in the @type property."
        },
        {
          "name": "Metadata",
          "type": "Dynamic",
          "description": "Other service-specific data about the request, response, and other information associated with the current audited event."
        },
        {
          "name": "StatusMessage",
          "type": "String",
          "description": "The message status of the overall operation."
        },
        {
          "name": "PrincipalEmail",
          "type": "String",
          "description": "The email address of the authenticated user (or service account on behalf of third party principal) making the request. For third party identity callers, the principalSubject field is populated instead of this field. For privacy reasons, the principal email address is sometimes redacted."
        },
        {
          "name": "LogName",
          "type": "String",
          "description": "Information including a suffix identifying the log sub-type (e.g., admin activity, system access, data access) and where in the hierarchy the request was made."
        },
        {
          "name": "Timestamp",
          "type": "DateTime",
          "description": "The time the event described by the log entry occurred."
        },
        {
          "name": "ProjectId",
          "type": "String",
          "description": "The identifier of the Google Cloud Platform (GCP) project associated with this resource, such as \"my-project\"."
        },
        {
          "name": "Severity",
          "type": "String",
          "description": "Optional. The severity of the log entry. For example, the following filter expression will match log entries with severities INFO, NOTICE, and WARNING."
        },
        {
          "name": "GCPResourceType",
          "type": "String",
          "description": "The identifier of the type associated with this resource, such as 'pubsub_subscription'."
        },
        {
          "name": "Subscription",
          "type": "String",
          "description": "A named resource representing the stream of messages from a single, specific topic, to be delivered to the subscribing application."
        },
        {
          "name": "ResourceLocation",
          "type": "Dynamic",
          "description": "The resource location information."
        },
        {
          "name": "ResourceOriginalState",
          "type": "Dynamic",
          "description": "The resource original state before mutation. Present only for operations which have successfully modified the targeted resource(s). In general, this field should contain all changed fields, except those that are already been included in request, response, metadata or serviceData fields. When the JSON object represented here has a proto equivalent, the proto name will be indicated in the @type property."
        },
        {
          "name": "ServiceData",
          "type": "Dynamic",
          "description": "An object containing fields of an arbitrary type. An additional field \"@type\" contains a URI identifying the type. Example: { \"id\": 1234, \"@type\": \"types.example.com/standard/id\" }."
        },
        {
          "name": "InsertId",
          "type": "String",
          "description": "Optional. Providing a unique identifier for the log entry allows Logging to remove duplicate entries with the same timestamp and insertId in a single query result."
        }
      ],
      "sampleInputRecordsFilePath": "SampleInputRecords/GCPAuditLogsSample.json",
      "sampleOutputRecordsFilePath": "SampleOutputRecords/GCPAuditLogsSample.json"
    }
  ],
  "functions": [],
  "queries": []
}
